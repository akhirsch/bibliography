\subsection{Control Language}
\label{sec:control-lang}

\todo purpose and design of control language

\todo explanation of AmI and reason it's needed

\begin{figure}
  \begin{syntax}
    \category[Control Expression]{E}
    \alternative{X} \alternative{\CtrlFail} \alternative{\Ret{e}} \alternative{\CtrlSeq{E_1}{E_2}} \alternative{\lambda X.E} \alternative{\mu X.E} \alternative{\ctrlapp{E_1}{E_2}} \\
    \alternative{\SendTo{E}{\ell}} \alternative{\RecvFrom{\ell}} \\
    \alternative{\ChooseFor{d}{\ell}{E}} \alternative{\AllowChoice{\ell}{E_1}{E_2}} \\
    \alternative{\ifthen{E}{E_1}{E_2}} \\
    \alternative{\Lambda \alpha.E} \alternative{\ctrlapp{E}{t}} \\
    \alternative{\LetIn{\Ret{x}}{E_1}{E_2}}\\
    \alternative{\LetSendIn{\alpha \knd *_\ell}{E_1}{\rho}{E_2}} \alternative{\LetRecvIn{\alpha \knd *_\ell}{\ell}{E}}\\
    \alternative{\LetSendIn{\alpha \knd *_e}{E_1}{\rho}{E_2}} \alternative{\LetRecvIn{\alpha \knd *_e}{\ell}{E}}\\
    \alternative{\AmI{\ell}{E_1}{E_2}}

    \category[Systems]{\Pi}
    \alternative{L_1 \triangleright E_1 \;\|\; \ldots \;\|\; L_n \triangleright E_n}
  \end{syntax}

  \caption{Control Expressions}
  \label{fig:control-lang-syntax}
\end{figure}

\paragraph{Operational Semantics}
\label{sec:control-lang-semantics}

\begin{figure}
  \begin{mathparpagebreakable}
      \infer[RetE]{e_1 \localstep e_2}
      {\Ret{e_1} \ctrlstep[\iota] \Ret{e_2}} \and

      \infer[SendV]{\text{Value}(V)}
      {\SendTo{V}{L} \ctrlstep[V \sendsto L] \CtrlFail} \and

      \infer[RecvV]{\text{Value}(V)}
      {\RecvFrom{L} \ctrlstep[L;V \sendsto] V} \and

      \infer[Choose]{}
      {\ChooseFor{d}{L}{E} \ctrlstep[d \sendsto L] E} \and

      \infer[AllowChoiceL]{}
      {\AllowChoice{L}{E_1}{E_2} \ctrlstep[L;\Left \sendsto] E_1} \and

      \infer[AllowChoiceR]{}
      {\AllowChoice{L}{E_1}{E_2} \ctrlstep[L;\Right \sendsto] E_2} \and

      \infer[AmIL]{}
      {\AmI{L}{E_1}{E_2} \ctrlstep[L] E_1} \and

      \infer[AmIR]{L \neq L'}
      {\AmI{L}{E_1}{E_2} \ctrlstep[L'] E_2} \and
  \end{mathparpagebreakable}
  \caption{Control Language Semantics}
  \label{fig:control-lang-sem}
\end{figure}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "conference"
%%% End: